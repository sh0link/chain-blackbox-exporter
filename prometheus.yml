scrape_configs:
- job_name: ethrpc-chaininfo
  metrics_path: /probe
  params:
    module: [ chain_info ]
    useBatch: [ "true" ]
  static_configs:
    - targets:
        - https://eth.drpc.org
        - https://sepolia.drpc.org
        - https://bsc-testnet-dataseed.bnbchain.org
        - https://bsc-dataseed.bnbchain.org
  relabel_configs:
    - source_labels: [__address__]
      target_label: __param_target
    - source_labels: [__param_target]
      target_label: instance
    - target_label: __address__
      replacement: 127.0.0.1:9115
- job_name: ethrpc-balance
  metrics_path: /probe
  params:
    module: [ balance ]
    useBatch: [ "true" ]
    account:
      - "Binance34:0x28C6c06298d514Db089934071355E5743bf21d60"
      - "Binance91:0x21a31Ee1afC51d94C2eFcCAa2092aD1028285549"
      - "Binance90:0x47ac0Fb4F2D84898e4D9E7b4DaB3C24507a6D503"
  static_configs:
    - targets:
        - https://eth.drpc.org
  relabel_configs:
    - source_labels: [__address__]
      target_label: __param_target
    - source_labels: [__param_target]
      target_label: instance
    - target_label: __address__
      replacement: 127.0.0.1:9115
- job_name: ethrpc-erc20balance-usdc
  metrics_path: /probe
  params:
    module: [ erc20balance ]
    useBatch: [ "true" ]
    account:
      - "Binance34:0x28C6c06298d514Db089934071355E5743bf21d60"
      - "Binance91:0x21a31Ee1afC51d94C2eFcCAa2092aD1028285549"
      - "Binance90:0x47ac0Fb4F2D84898e4D9E7b4DaB3C24507a6D503"
    token:
      - "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"
  static_configs:
    - targets:
        - https://eth.drpc.org
  relabel_configs:
    - source_labels: [__address__]
      target_label: __param_target
    - source_labels: [__param_target]
      target_label: instance
    - target_label: __address__
      replacement: 127.0.0.1:9115
- job_name: ethrpc-contractcall
  scrape_interval: 10s
  metrics_path: /probe
  params:
    module: [ contract_call ]
    useBatch: [ "true" ]
    # Format: contractName:address|methodSig|params|returnName:returnIndex|decimal (name optional, used as metric label)
    call:
      # Single return: USDC ERC20 balanceOf / totalSupply (one arg)
      - USDC:0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48|balanceOf(address)(uint256)|0x28C6c06298d514Db089934071355E5743bf21d60|balance:0|6
      - USDC:0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48|totalSupply()(uint256)||totalSupply:0|6
      # Two args: ERC20 allowance(owner, spender), comma-separated
      - USDC:0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48|allowance(address,address)(uint256)|0x28C6c06298d514Db089934071355E5743bf21d60,0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D|allowance:0|6
      # Address return: owner() (e.g. Uniswap V2 Router owner)
      - USDC:0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48|owner()(address)||owner:0|0
      # Multiple returns: Uniswap V2 WETH/USDC pool getReserves() -> (reserve0, reserve1, blockTimestampLast)
      - UniswapV2_WETH_USDC:0xB4e16d0168e52d35CaCD2c6185b44281Ec28C9Dc|getReserves()(uint112,uint112,uint32)||reserve0:0|6
      - UniswapV2_WETH_USDC:0xB4e16d0168e52d35CaCD2c6185b44281Ec28C9Dc|getReserves()(uint112,uint112,uint32)||reserve1:1|18
      - UniswapV2_WETH_USDC:0xB4e16d0168e52d35CaCD2c6185b44281Ec28C9Dc|getReserves()(uint112,uint112,uint32)||blockTimestampLast:2|0
      # Multiple returns: Chainlink ETH/USD latestRoundData() -> (roundId, answer, startedAt, updatedAt, answeredInRound)
      - Chainlink_ETH_USD:0x5f4eC3Df9cbd43714FE2740f5E3616155c5b8419|latestRoundData()(uint80,int256,uint256,uint256,uint80)||answer:1|8
  static_configs:
    - targets:
        - https://eth.drpc.org
  relabel_configs:
    - source_labels: [__address__]
      target_label: __param_target
    - source_labels: [__param_target]
      target_label: instance
    - target_label: __address__
      replacement: 127.0.0.1:9115

# 通用 JSON-RPC：异构链区块高度 (params: method, rpcParams JSON, resultJMESPath, decimal)
- job_name: jsonrpc-eth-height
  metrics_path: /probe
  params:
    module: [ jsonrpc ]
    method: [ eth_blockNumber ]
    rpcParams: [ '[]' ]
    resultJMESPath: [ '@' ]
    decimal: [ '0' ]
  static_configs:
    - targets:
        - https://eth.drpc.org
  relabel_configs:
    - source_labels: [__address__]
      target_label: __param_target
    - source_labels: [__param_target]
      target_label: instance
    - target_label: __address__
      replacement: 127.0.0.1:9115

# BTC: 需使用支持 getblockcount 的 Bitcoin Core RPC（如自建节点或 RPC 服务）
- job_name: jsonrpc-btc-height
  metrics_path: /probe
  params:
    module: [ jsonrpc ]
    method: [ getblockcount ]
    rpcParams: [ '[]' ]
    resultJMESPath: [ '@' ]
    decimal: [ '0' ]
  static_configs:
    - targets:
        - https://bitcoin-rpc.publicnode.com
  relabel_configs:
    - source_labels: [__address__]
      target_label: __param_target
    - source_labels: [__param_target]
      target_label: instance
    - target_label: __address__
      replacement: 127.0.0.1:9115

# 示例：resultJMESPath 取 JSON 子节点。getblockchaininfo 返回对象，用 "blocks" 取当前区块高度
- job_name: jsonrpc-btc-blocks-jmespath
  metrics_path: /probe
  params:
    module: [ jsonrpc ]
    method: [ getblockchaininfo ]
    rpcParams: [ '[]' ]
    resultJMESPath: [ 'blocks' ]
    decimal: [ '0' ]
  static_configs:
    - targets:
        - https://bitcoin-rpc.publicnode.com
  relabel_configs:
    - source_labels: [__address__]
      target_label: __param_target
    - source_labels: [__param_target]
      target_label: instance
    - target_label: __address__
      replacement: 127.0.0.1:9115

- job_name: jsonrpc-solana-height
  metrics_path: /probe
  params:
    module: [ jsonrpc ]
    method: [ getBlockHeight ]
    rpcParams: [ '[]' ]
    # rpcParams: [ '[{"commitment":"finalized"}]' ]
    resultJMESPath: [ '@' ]
    decimal: [ '0' ]
  static_configs:
    - targets:
        - https://api.mainnet-beta.solana.com
  relabel_configs:
    - source_labels: [__address__]
      target_label: __param_target
    - source_labels: [__param_target]
      target_label: instance
    - target_label: __address__
      replacement: 127.0.0.1:9115

- job_name: jsonrpc-sui-height
  metrics_path: /probe
  params:
    module: [ jsonrpc ]
    method: [ sui_getLatestCheckpointSequenceNumber ]
    rpcParams: [ '[]' ]
    resultJMESPath: [ '@' ]
    decimal: [ '0' ]
  static_configs:
    - targets:
        - https://fullnode.mainnet.sui.io
  relabel_configs:
    - source_labels: [__address__]
      target_label: __param_target
    - source_labels: [__param_target]
      target_label: instance
    - target_label: __address__
      replacement: 127.0.0.1:9115

# GET 任意 URL，响应为 JSON，用 resultJMESPath 取指定值（如监控网站 JSON API）
# 示例：Ethereum Beacon API 当前 slot — target=beacon 节点 /eth/v1/node/syncing，取 data.head_slot
- job_name: http_json-beacon-slot
  metrics_path: /probe
  params:
    module: [ http_json ]
    resultJMESPath: [ 'data.head_slot' ]
    decimal: [ '0' ]
  static_configs:
    - targets:
        - https://ethereum-beacon-api.publicnode.com/eth/v1/node/syncing
  relabel_configs:
    - source_labels: [__address__]
      target_label: __param_target
    - source_labels: [__param_target]
      target_label: instance
    - target_label: __address__
      replacement: 127.0.0.1:9115